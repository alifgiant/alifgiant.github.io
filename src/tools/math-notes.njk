---
layout: layouts/base.njk
title: Math Notes
permalink: /tools/math-notes/
---

{# mathjs for calculation #}
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>

<div class="w-full max-w-5xl flex flex-col gap-12" x-data="mathNotes()">
    {# Header #}
    <div class="flex flex-col gap-4">
        <div class="w-16 h-16 rounded-2xl bg-indigo-500/10 flex items-center justify-center text-indigo-500">
            <span class="material-symbols-outlined text-4xl">calculate</span>
        </div>
        <h1 class="text-4xl md:text-6xl font-bold text-text-main font-display">
            Math Notes
        </h1>
        <p class="text-lg text-text-muted max-w-2xl leading-relaxed">
            A smart scratchpad for your calculations. Type expressions line by line and see results instantly.
        </p>
    </div>

    {# Toolbar #}
    <div class="flex flex-wrap gap-4 items-center justify-between bg-stone-50 p-4 rounded-3xl border border-stone-100">
        <div class="flex gap-2">
            <button @click="clearAll()" class="px-6 py-2.5 rounded-full bg-white border border-stone-200 text-text-main font-medium hover:bg-stone-50 transition-all flex items-center gap-2">
                <span class="material-symbols-outlined text-xl">delete</span>
                Clear All
            </button>
            <button @click="copyResults()" class="px-6 py-2.5 rounded-full bg-white border border-stone-200 text-text-main font-medium hover:bg-stone-50 transition-all flex items-center gap-2">
                <span class="material-symbols-outlined text-xl">content_copy</span>
                Copy Results
            </button>
        </div>
        <div class="text-sm text-text-muted italic px-4">
            Supports variables, percentages, and units.
        </div>
    </div>

    {# Editor Container #}
    <div class="relative bg-[#1e1e1e] rounded-[2.5rem] border border-stone-800 shadow-2xl overflow-hidden min-h-[500px] flex">
        {# Input Area #}
        <div class="flex-1 relative">
            <textarea 
                x-ref="input"
                x-model="input" 
                @input="calculate()"
                @scroll="syncScroll()"
                spellcheck="false"
                class="math-input w-full h-full min-h-[500px] bg-transparent text-white font-mono resize-none focus:outline-none border-none overflow-y-auto custom-scrollbar"
                placeholder="Type your calculations here...
e.g. 100 + 20%
salary = 5000
tax = 15%
total tax = salary * tax"></textarea>
        </div>

        {# Divider line #}
        <div class="w-[1px] bg-stone-800"></div>

        {# Results Area #}
        <div 
            x-ref="results"
            class="math-results w-32 md:w-64 bg-[#1a1a1a] text-[#84cc16] font-mono text-right pointer-events-none overflow-hidden select-none">
            <template x-for="(result, index) in results" :key="index">
                <div class="math-line" x-text="result"></div>
            </template>
        </div>
    </div>

    {# Help / Tips #}
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="p-8 rounded-[2rem] bg-indigo-50/50 border border-indigo-100/50">
            <h3 class="text-lg font-bold text-indigo-900 mb-3 flex items-center gap-2">
                <span class="material-symbols-outlined">percentage</span>
                Percentages
            </h3>
            <p class="text-sm text-indigo-800/80 leading-relaxed">
                Easily add or subtract percentages. <br>
                <code class="bg-indigo-100 px-1 rounded">100 + 10%</code> = 110 <br>
                <code class="bg-indigo-100 px-1 rounded">500 - 25%</code> = 375
            </p>
        </div>
        <div class="p-8 rounded-[2rem] bg-emerald-50/50 border border-emerald-100/50">
            <h3 class="text-lg font-bold text-emerald-900 mb-3 flex items-center gap-2">
                <span class="material-symbols-outlined">variable</span>
                Variables
            </h3>
            <p class="text-sm text-emerald-800/80 leading-relaxed">
                Save values to variables for later use. <br>
                <code class="bg-emerald-100 px-1 rounded">price = 250</code> <br>
                <code class="bg-emerald-100 px-1 rounded">total = price * 2</code>
            </p>
        </div>
        <div class="p-8 rounded-[2rem] bg-amber-50/50 border border-amber-100/50">
            <h3 class="text-lg font-bold text-amber-900 mb-3 flex items-center gap-2">
                <span class="material-symbols-outlined">straighten</span>
                Units
            </h3>
            <p class="text-sm text-amber-800/80 leading-relaxed">
                Convert between common units. <br>
                <code class="bg-amber-100 px-1 rounded">5 km to meters</code> <br>
                <code class="bg-amber-100 px-1 rounded">2 hours to minutes</code>
            </p>
        </div>
    </div>
</div>

<style>
    /* Math Notes line alignment */
    .math-input,
    .math-results {
        font-size: 18px;
        line-height: 40px;
        padding: 32px;
    }
    @media (min-width: 768px) {
        .math-input,
        .math-results {
            font-size: 20px;
            line-height: 48px;
            padding: 48px;
        }
    }
    .math-results {
        padding-left: 16px;
        padding-right: 16px;
    }
    .math-line {
        height: 40px;
        overflow: hidden;
        white-space: nowrap;
    }
    @media (min-width: 768px) {
        .math-line {
            height: 48px;
        }
    }

    .custom-scrollbar::-webkit-scrollbar {
        width: 8px;
    }
    .custom-scrollbar::-webkit-scrollbar-track {
        background: #1e1e1e;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #333;
        border-radius: 4px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: #444;
    }
</style>

<script>
    function mathNotes() {
        return {
            input: '',
            results: [],
            scope: {},

            init() {
                // Initialize with some example data if empty
                this.input = '1 + 2\n100 - 10%\n\nsalary = 5000\ntax = 15%\ntotal_tax = salary * tax\n\n5 km to meters\n2 meters + 50 cm';
                this.calculate();
            },

            calculate() {
                const lines = this.input.split('\n');
                this.results = [];
                this.scope = {}; // Reset scope on each calculation for clean state

                lines.forEach((line) => {
                    const trimmedLine = line.trim();
                    if (!trimmedLine) {
                        this.results.push('');
                        return;
                    }

                    try {
                        // Math.js evaluation
                        const result = math.evaluate(trimmedLine, this.scope);
                        
                        if (result === undefined) {
                            this.results.push('');
                        } else if (typeof result === 'function') {
                            this.results.push('function');
                        } else if (result && result.isUnit) {
                            this.results.push(result.toString());
                        } else if (typeof result === 'object' && !Array.isArray(result)) {
                            this.results.push(''); // Assignments return object but we don't show result
                        } else {
                            // Format number to be readable
                            this.results.push(this.formatResult(result));
                        }
                    } catch (e) {
                        this.results.push('');
                    }
                });
            },

            formatResult(res) {
                if (typeof res === 'number') {
                    if (Number.isInteger(res)) return res.toString();
                    return res.toLocaleString(undefined, { maximumFractionDigits: 4 });
                }
                return res.toString();
            },

            syncScroll() {
                this.$refs.results.scrollTop = this.$refs.input.scrollTop;
            },

            clearAll() {
                this.input = '';
                this.results = [];
                this.scope = {};
                this.$refs.input.focus();
            },

            copyResults() {
                const text = this.results.filter(r => r !== '').join('\n');
                if (!text) return;
                
                navigator.clipboard.writeText(text).then(() => {
                    alert('Results copied to clipboard!');
                });
            }
        }
    }
</script>
