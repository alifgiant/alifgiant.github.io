---
layout: layouts/base.njk
title: Text Diff
description: Compare two strings or code snippets to find differences.
permalink: /tools/diff/
---

<script src="https://cdn.jsdelivr.net/npm/diff@5.2.0/dist/diff.min.js"></script>

<div class="w-full max-w-6xl flex flex-col gap-12" x-data="diffTool()">
    {# Header #}
    {% set tool = {} %}
    {% for item in site.pages.tools.list %}
        {% if item.url == "/tools/diff/" %}
            {% set tool = item %}
        {% endif %}
    {% endfor %}
    {% set cat = site.pages.tools.categories[tool.tag] %}
    
    <div class="flex flex-col gap-4 text-center items-center">
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider border {{ cat.color }}">
            <span class="material-symbols-outlined text-sm">{{ cat.icon }}</span>
            {{ tool.tag }}
        </div>
        <div class="w-16 h-16 rounded-2xl {{ cat.lightColor }} flex items-center justify-center mb-2">
            <span class="material-symbols-outlined text-4xl">{{ tool.icon }}</span>
        </div>
        <h1 class="text-4xl md:text-6xl font-bold text-text-main font-display">
            {{ tool.title }}
        </h1>
        <p class="text-lg text-text-muted max-w-xl leading-relaxed">
            {{ tool.description }}
        </p>
    </div>

    {# Comparison Inputs #}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="bg-white/80 backdrop-blur-md border border-white rounded-[2.5rem] p-6 shadow-xl shadow-primary/5">
            <label class="text-xs font-bold uppercase tracking-widest text-text-muted ml-4 mb-2 block">Original Text (A)</label>
            <textarea x-model="textA" @input="compare()" rows="10" placeholder="Paste your original text here..." class="block w-full px-6 py-4 bg-stone-50 border-2 border-stone-100 rounded-2xl text-text-main placeholder-stone-400 focus:outline-none focus:border-primary/30 focus:bg-white transition-all font-mono text-sm shadow-inner resize-none"></textarea>
            <div class="mt-3 ml-4 text-[10px] font-bold text-text-muted uppercase tracking-widest flex items-center gap-2">
                <span class="material-symbols-outlined text-xs">format_align_left</span>
                Length: <span x-text="textA.length" class="text-primary"></span> characters
            </div>
        </div>
        <div class="bg-white/80 backdrop-blur-md border border-white rounded-[2.5rem] p-6 shadow-xl shadow-primary/5">
            <label class="text-xs font-bold uppercase tracking-widest text-text-muted ml-4 mb-2 block">Modified Text (B)</label>
            <textarea x-model="textB" @input="compare()" rows="10" placeholder="Paste your modified text here..." class="block w-full px-6 py-4 bg-stone-50 border-2 border-stone-100 rounded-2xl text-text-main placeholder-stone-400 focus:outline-none focus:border-primary/30 focus:bg-white transition-all font-mono text-sm shadow-inner resize-none"></textarea>
            <div class="mt-3 ml-4 text-[10px] font-bold text-text-muted uppercase tracking-widest flex items-center gap-2">
                <span class="material-symbols-outlined text-xs">format_align_left</span>
                Length: <span x-text="textB.length" class="text-primary"></span> characters
            </div>
        </div>
    </div>

    {# Results #}
    <div x-show="textA || textB" class="bg-white/80 backdrop-blur-md border border-white rounded-[2.5rem] p-8 md:p-12 shadow-2xl shadow-primary/10 transition-all duration-500 animate-fade-in">
        <div class="flex flex-col gap-6">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold text-text-main font-display">Diff Result</h2>
                <div class="flex gap-4">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 bg-emerald-100 border border-emerald-200 rounded"></div>
                        <span class="text-xs font-bold text-text-muted uppercase tracking-wider">Added</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 bg-rose-100 border border-rose-200 rounded"></div>
                        <span class="text-xs font-bold text-text-muted uppercase tracking-wider">Removed</span>
                    </div>
                </div>
            </div>

            <div class="bg-stone-50 border-2 border-stone-100 rounded-2xl min-h-[200px] overflow-hidden shadow-inner">
                <div class="overflow-x-auto">
                    <table class="w-full font-mono text-sm border-collapse">
                        <template x-for="line in diffResults">
                            <tr :class="{
                                'bg-rose-100/50 text-rose-900': line.type === 'removed',
                                'bg-emerald-100/50 text-emerald-900': line.type === 'added',
                                'hover:bg-stone-100/50 transition-colors': line.type === 'unchanged'
                            }">
                                <td class="w-12 px-3 py-1 text-right border-r border-stone-200 text-stone-400 select-none bg-stone-100/30 whitespace-nowrap" x-text="line.oldLine"></td>
                                <td class="w-12 px-3 py-1 text-right border-r border-stone-200 text-stone-400 select-none bg-stone-100/30 whitespace-nowrap" x-text="line.newLine"></td>
                                <td class="w-8 px-2 py-1 text-center select-none font-bold" :class="line.type === 'added' ? 'text-emerald-600' : (line.type === 'removed' ? 'text-rose-600' : 'text-stone-300')" x-text="line.type === 'added' ? '+' : (line.type === 'removed' ? '-' : ' ')"></td>
                                <td class="px-4 py-1 whitespace-pre break-all md:break-normal" x-text="line.content"></td>
                            </tr>
                        </template>
                    </table>
                </div>
                <div x-show="textA && textB && diffResults.length > 0 && diffResults.every(l => l.type === 'unchanged')" class="p-12 text-center text-text-muted italic bg-white/50">
                    Both texts are identical.
                </div>
                <div x-show="!textA && !textB" class="p-12 text-center text-stone-300 italic flex flex-col items-center gap-2">
                    <span class="material-symbols-outlined text-4xl">compare_arrows</span>
                    Enter text above to see differences
                </div>
            </div>
        </div>
    </div>

    {# Back Button #}
    <div class="flex justify-center">
        <a href="/tools/" class="flex items-center gap-2 text-text-muted hover:text-primary transition-colors font-bold uppercase tracking-widest text-xs">
            <span class="material-symbols-outlined text-sm">arrow_back</span>
            Back to Tools
        </a>
    </div>
</div>

<script>
    function diffTool() {
        return {
            textA: '',
            textB: '',
            diffResults: [],

            compare() {
                if (!window.Diff) return;
                
                // Use line-based diff for Git-like comparison
                const diff = Diff.diffLines(this.textA, this.textB);
                const results = [];
                let oldLineNum = 1;
                let newLineNum = 1;

                diff.forEach(part => {
                    const lines = part.value.split('\n');
                    
                    // The last element of split is often empty if the value ends with \n
                    // We remove it unless it's the only element (empty file case)
                    if (lines.length > 1 && lines[lines.length - 1] === '') {
                        lines.pop();
                    }

                    lines.forEach(lineContent => {
                        if (part.added) {
                            results.push({
                                type: 'added',
                                oldLine: ' ',
                                newLine: newLineNum++,
                                content: lineContent
                            });
                        } else if (part.removed) {
                            results.push({
                                type: 'removed',
                                oldLine: oldLineNum++,
                                newLine: ' ',
                                content: lineContent
                            });
                        } else {
                            results.push({
                                type: 'unchanged',
                                oldLine: oldLineNum++,
                                newLine: newLineNum++,
                                content: lineContent
                            });
                        }
                    });
                });

                this.diffResults = results;
            }
        }
    }
</script>
